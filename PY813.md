## Definición de 5 consultas que utilicen subconsultas, tanto escalares, como fila y de tabla.

### 1. Empleados que no tienen encaragdo (usando NOT IN) (Vanesa Sekeresh)
```sql
SELECT e.dni, e.nombre FROM EMPLEADO e WHERE e.dni IN
(SELECT DISTINCT encargado e1 FROM EMPLEADO WHERE encargado IS NOT NULL);
```
<img width="387" alt="Consulta1" src="https://github.com/user-attachments/assets/cf6d6576-4067-4075-bf91-c3cb716aab64"/>

### 2. Recupera el nombre y el salario de aquellos empleados que cobra más que el salario medio ordenandolo descendentemente. (Vanesa Sekeresh)
```sql
SELECT e.nombre, e.salario FROM EMPLEADO e where e.salario >
(SELECT avg(e.salario) from EMPLEADO e)
ORDER BY e.salario DESC;
```
<img width="387" alt="image" src="https://github.com/user-attachments/assets/55ce6872-45db-4fb5-b2d7-9a73bd48343c" />

### 3. Recupera el cliente con más compras realizadas. (Jessica Brotons)
```sql
SELECT idCliente, nombre, apellido1, apellido2
FROM CLIENTE
WHERE idCliente = (
    SELECT idCliente
    FROM COMPRA
    GROUP BY idCliente
    ORDER BY COUNT(numCompra) DESC
    LIMIT 1
);
```
![image](https://github.com/user-attachments/assets/16c983b9-288c-47eb-a910-c71fdb083b9a)


### 4. 
```sql

```
<img width="402" alt="image" src="" />

### 5.
```sql

```
<img width="402" alt="image" src= "" />


## Definición de 2 consultas que utilicen CTE.

### 1. Obtener los repartidores que han realizado más de 3 entregas.(Jessica Brotons)
```sql
WITH RepartidoresFrecuentes AS (
    SELECT dniRepartidor, COUNT(numCompra) AS total_entregas
    FROM COMPRA
    WHERE dniRepartidor IS NOT NULL
    GROUP BY dniRepartidor
    HAVING COUNT(numCompra) > 3
)
SELECT r.dni, e.nombre, r.matricula, rf.total_entregas
FROM REPARTIDOR r 
JOIN EMPLEADO e ON r.dni = e.dni
JOIN RepartidoresFrecuentes rf ON r.dni = rf.dniRepartidor;
```
![image](https://github.com/user-attachments/assets/8695d4e3-c43e-4c1b-9834-6ce29bb9bb2b)

### 2. 
```sql

```


## Creación de una tabla a partir del resultado de una consulta compleja.

### 1. 
```sql

```
<img width="447" alt="image" src="" />



## Definición de dos índices que mejoren el rendimiento de las consultas ya definidas.

### 1. Recupera el nombre y el salario de aquellos empleados que cobra más que el salario medio ordenandolo descendentemente. (Vanesa Sekeresh)
```sql
CREATE INDEX idx_salarioEmp ON EMPLEADO(salario);
```
<img width="447" alt="image" src="https://github.com/user-attachments/assets/c932b9de-193c-4189-a260-e01bc0360890" />

### 2. Creación de un índice en la tabla COMPRA para mejorar las consultas por idCliente. (Jessica Brotons)
```sql
CREATE INDEX idx_compra_idCliente ON COMPRA(idCliente);
```
![image](https://github.com/user-attachments/assets/deb85235-b97f-4f87-989e-13653247594f)



## Planes de ejecución, antes y después de la creación de los índices, comprobando su uso.


### 1. Recupera el nombre y el salario de aquellos empleados que cobra más que el salario medio ordenandolo descendentemente. (Vanesa Sekeresh) 
```sql

```
<img width="447" alt="image" src="" />

### 2. 
```sql

```
<img width="447" alt="image" src="" />

